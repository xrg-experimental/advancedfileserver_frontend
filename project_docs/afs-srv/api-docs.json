{"openapi":"3.0.1","info":{"title":"Advanced File Server API","description":"REST API documentation for Advanced File Server","license":{"name":"Apache 2.0","url":"https://springdoc.org"},"version":"1.0"},"servers":[{"url":"http://localhost:8080/api","description":"Generated server url"}],"security":[{"Bearer Authentication":[]}],"tags":[{"name":"Authentication","description":"Authentication management APIs"}],"paths":{"/api/users/{username}":{"put":{"tags":["user-controller"],"summary":"Update user","description":"Partially update user information","operationId":"updateUser","parameters":[{"name":"username","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateUserRequest"}}},"required":true},"responses":{"400":{"description":"Invalid request data or non-existent groups/roles","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDTO"}}}},"200":{"description":"User updated successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDTO"}}}},"404":{"description":"User not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDTO"}}}},"403":{"description":"Not authorized to update users","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDTO"}}}}}}},"/api/profile":{"get":{"tags":["profile-controller"],"operationId":"getCurrentUserProfile","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProfileDTO"}}}}}},"put":{"tags":["profile-controller"],"operationId":"updateCurrentUserProfile","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateProfileRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ProfileDTO"}}}}}}},"/api/groups/{id}/permissions":{"put":{"tags":["group-controller"],"operationId":"updateGroupPermissions","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateGroupPermissionsRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GroupDTO"}}}}}}},"/api/groups/{id}/base-path":{"put":{"tags":["group-controller"],"operationId":"updateGroupBasePath","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateGroupRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GroupDTO"}}}}}}},"/api/groups/{groupId}/members/{userId}":{"put":{"tags":["group-membership-controller"],"operationId":"addUserToGroup","parameters":[{"name":"groupId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"userId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GroupDTO"}}}}}},"delete":{"tags":["group-membership-controller"],"operationId":"removeUserFromGroup","parameters":[{"name":"groupId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"userId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GroupDTO"}}}}}}},"/auth/sessions/{username}/{sessionId}/revoke":{"post":{"tags":["Authentication"],"summary":"Revoke specific session","description":"Invalidates a specific session for a user","operationId":"revokeUserSession","parameters":[{"name":"username","in":"path","required":true,"schema":{"type":"string"}},{"name":"sessionId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Successfully revoked session"},"404":{"description":"Session not found"},"403":{"description":"Not authorized to revoke session"}}}},"/auth/sessions/{username}/revoke":{"post":{"tags":["Authentication"],"summary":"Revoke all user sessions","description":"Invalidates all active sessions for a specific user","operationId":"revokeUserSessions","parameters":[{"name":"username","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Successfully revoked all sessions"},"404":{"description":"User not found"},"403":{"description":"Not authorized to revoke sessions"}}}},"/auth/refresh":{"post":{"tags":["Authentication"],"summary":"Refresh token","description":"Refreshes an existing valid JWT token","operationId":"refreshToken","parameters":[{"name":"Authorization","in":"header","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Token successfully refreshed","content":{"*/*":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"401":{"description":"Invalid or expired token","content":{"*/*":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"400":{"description":"Invalid request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}}}}},"/auth/otp-login":{"post":{"tags":["Authentication"],"summary":"OTP login","description":"Authenticates user with OTP code and returns JWT token","operationId":"otpLogin","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OtpLoginRequest"}}},"required":true},"responses":{"400":{"description":"Invalid request"},"200":{"description":"Successfully authenticated","content":{"*/*":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"401":{"description":"Invalid authentication"}}}},"/auth/logout":{"post":{"tags":["Authentication"],"summary":"Logout user","description":"Invalidates the current session and blacklists the token","operationId":"logout","parameters":[{"name":"Authorization","in":"header","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Successfully logged out"},"401":{"description":"Invalid token"},"400":{"description":"Invalid request"}}}},"/auth/login":{"post":{"tags":["Authentication"],"summary":"Login user","description":"Authenticates user and returns JWT token","operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"400":{"description":"Invalid request"},"401":{"description":"Invalid credentials"},"201":{"description":"Authentication postponed (OTP required)","content":{"*/*":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"200":{"description":"Successfully authenticated","content":{"*/*":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}}}}},"/api/users":{"get":{"tags":["user-controller"],"summary":"List all users","description":"Retrieve a list of all users in the system","operationId":"getAllUsers","responses":{"200":{"description":"Successfully retrieved users","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserDTO"}}}}},"403":{"description":"Not authorized to view users","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserDTO"}}}}}}},"post":{"tags":["user-controller"],"summary":"Create new user","description":"Create a new user account in the system","operationId":"createUser","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserRequest"}}},"required":true},"responses":{"409":{"description":"Username already exists","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDTO"}}}},"201":{"description":"User created successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDTO"}}}},"403":{"description":"Not authorized to create users","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDTO"}}}},"400":{"description":"Invalid request data","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDTO"}}}}}}},"/api/registration":{"post":{"tags":["registration-controller"],"operationId":"registerUser","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegistrationRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDTO"}}}}}}},"/api/groups":{"post":{"tags":["group-controller"],"operationId":"createGroup","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateGroupRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GroupDTO"}}}}}}},"/api/users/{username}/status":{"patch":{"tags":["user-controller"],"summary":"Enable/disable user","description":"Toggle user account status","operationId":"updateUserStatus","parameters":[{"name":"username","in":"path","required":true,"schema":{"type":"string"}},{"name":"enabled","in":"query","required":true,"schema":{"type":"boolean"}}],"responses":{"404":{"description":"User not found","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDTO"}}}},"200":{"description":"User status updated successfully","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDTO"}}}},"403":{"description":"Not authorized to modify user status","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDTO"}}}}}}},"/system/status":{"get":{"tags":["system-controller"],"operationId":"getSystemStatus","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SystemStatusResponse"}}}}}}},"/auth/sessions/{username}":{"get":{"tags":["Authentication"],"summary":"Get user sessions","description":"Retrieves all sessions for a specific user","operationId":"getUserSessions","parameters":[{"name":"username","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Successfully retrieved sessions","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserSession"}}}}},"403":{"description":"Not authorized to view sessions","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserSession"}}}}},"404":{"description":"User not found","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserSession"}}}}}}}},"/api/internal/test":{"get":{"tags":["test-controller"],"operationId":"internalTest","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/api/groups/{groupId}/members":{"get":{"tags":["group-membership-controller"],"operationId":"getGroupMembers","parameters":[{"name":"groupId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserDTO"}}}}}}}},"/api/external/test":{"get":{"tags":["test-controller"],"operationId":"externalTest","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/api/admin/test":{"get":{"tags":["test-controller"],"operationId":"adminTest","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}}},"components":{"schemas":{"UpdateUserRequest":{"type":"object","properties":{"email":{"type":"string"},"userType":{"type":"string","enum":["INTERNAL","EXTERNAL","ADMIN"]},"roles":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"groups":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"enabled":{"type":"boolean"}}},"UserDTO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"username":{"type":"string"},"email":{"type":"string"},"displayName":{"type":"string"},"enabled":{"type":"boolean"},"userType":{"type":"string","enum":["INTERNAL","EXTERNAL","ADMIN"]},"roles":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"groups":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"createdAt":{"type":"string","format":"date-time"},"lastLogin":{"type":"string","format":"date-time"}}},"UpdateProfileRequest":{"required":["displayName","email"],"type":"object","properties":{"displayName":{"maxLength":50,"minLength":3,"type":"string"},"email":{"type":"string"},"newPassword":{"maxLength":100,"minLength":8,"type":"string"}}},"ProfileDTO":{"required":["displayName","email"],"type":"object","properties":{"displayName":{"maxLength":50,"minLength":3,"type":"string"},"email":{"type":"string"},"username":{"type":"string"}}},"UpdateGroupPermissionsRequest":{"required":["canDelete","canRead","canShare","canUpload","canWrite"],"type":"object","properties":{"canRead":{"type":"boolean"},"canWrite":{"type":"boolean"},"canDelete":{"type":"boolean"},"canShare":{"type":"boolean"},"canUpload":{"type":"boolean"}}},"GroupDTO":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"name":{"type":"string"},"description":{"type":"string"},"basePath":{"type":"string"},"createdAt":{"type":"string","format":"date-time"},"canRead":{"type":"boolean"},"canWrite":{"type":"boolean"},"canDelete":{"type":"boolean"},"canShare":{"type":"boolean"},"canUpload":{"type":"boolean"}}},"UpdateGroupRequest":{"required":["basePath"],"type":"object","properties":{"basePath":{"pattern":"^/[a-zA-Z0-9/_-]+$","type":"string"}}},"LoginResponse":{"type":"object","properties":{"token":{"type":"string"},"username":{"type":"string"},"userType":{"type":"string"},"refreshWindowStart":{"type":"integer","format":"int64"},"refreshWindowEnd":{"type":"integer","format":"int64"},"otpRequired":{"type":"boolean"}}},"OtpLoginRequest":{"required":["otpCode","username"],"type":"object","properties":{"username":{"type":"string"},"password":{"type":"string"},"otpCode":{"type":"string"}}},"LoginRequest":{"required":["password","username"],"type":"object","properties":{"username":{"type":"string"},"password":{"type":"string"}}},"CreateUserRequest":{"required":["email","password","userType","username"],"type":"object","properties":{"username":{"type":"string"},"password":{"type":"string"},"email":{"type":"string"},"userType":{"type":"string","enum":["INTERNAL","EXTERNAL","ADMIN"]},"roles":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"groups":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"enabled":{"type":"boolean"}}},"RegistrationRequest":{"required":["email","password","username"],"type":"object","properties":{"username":{"maxLength":50,"minLength":3,"type":"string"},"email":{"type":"string"},"password":{"maxLength":2147483647,"minLength":8,"type":"string"},"displayName":{"type":"string"}}},"CreateGroupRequest":{"required":["basePath","name"],"type":"object","properties":{"name":{"maxLength":50,"minLength":3,"pattern":"^[a-zA-Z0-9_-]+$","type":"string"},"description":{"maxLength":255,"minLength":0,"type":"string"},"basePath":{"pattern":"^/[a-zA-Z0-9/_-]+$","type":"string"}}},"SystemStatusResponse":{"type":"object","properties":{"status":{"type":"string"},"lastChecked":{"type":"string"}}},"UserSession":{"type":"object","properties":{"sessionId":{"type":"string"},"username":{"type":"string"},"createdAt":{"type":"string","format":"date-time"},"lastAccessedAt":{"type":"string","format":"date-time"},"expiresAt":{"type":"string","format":"date-time"},"token":{"type":"string"},"active":{"type":"boolean"}}}},"securitySchemes":{"Bearer Authentication":{"type":"http","description":"Enter JWT token","scheme":"bearer","bearerFormat":"JWT"}}}}